<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../YTSync-sources/YTSync-sources.html">
<link rel="import" href="../YTSync-control-menu/YTSync-control-menu.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/paper-toast/paper-toast.html">
<style is="custom-style" include="iron-flex iron-flex-alignment"></style>
<dom-module id="ytsync-app">
    <template>
    <style>
    :host {
        display: block;
        flex: 1;
    }
    paper-toolbar {
        padding: 0 45px 0 45px;
        background-color: #252525;
        box-shadow: 0 2px 5px rgba(0,0,0,0.12), 0 2px 5px rgba(0,0,0,0.24);
        position: fixed;
        width: 100vw;
        z-index: 5;
    }
    paper-button {
            padding: 0.45em 0.57em;
    }    
    #main_container {
        position: relative;
        display: flex;
        flex-direction: row-reverse;
        align-items: flex-start;
        justify-content: space-around;
        width: 100vw;
        margin-top: 90px;        
    }
    #yt-app-action {
        width: 100%;
        height: auto;
        max-width: 1000px;        
        position: relative;
        display: flex;
        flex-direction: row-reverse;
        justify-content: space-between;
    }
    #controls {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
    }
    #addButton {
        background-color: #404040;
    }
    #logo {
        background: url('/img/logo.png') no-repeat left center;
        background-size: contain;
        width: 200px;
        height: 100%;
        display: block;
    }
    #sm_overlay {
        display: none;
        width: 100vw;
        height: calc(100vh - 90px);
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    #sm_overlay #logo{
        height: 60px;
        background-color: rgba(0,0,0,.2);
        border-radius: 2px;
    }
    #sm_overlay p{
        padding: 15px;
        background: #fff;
        margin: 15px;
        border-radius: 2px;
        text-align: justify;
        line-height: 1.4;
        box-shadow: 0 1px 15px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);        
    }
    .title {
        margin-left: 65px!important;
    }
    @media (max-width: 780px) {
        paper-toolbar, #main_container,  #controls{
            display: none;
        }
        #yt-app-action {
            justify-content: center;
        }
        #sm_overlay {
            display: flex;
        }
    }
    </style>
        <div id="sm_overlay">
            <span id="logo"></span>
            <p>We're sorry, Youtusync will only work on devices with a screen width bigger than 780px.</p>
        </div>
        <paper-toolbar>
            <span id="logo" class="title"></span>
            <ytsync-control-menu id="control-menu"></ytsync-control-menu>
            <paper-button raised on-tap="addPlayer" id="addButton"><iron-icon icon="icons:add"></iron-icon>&nbsp;Add Video</paper-button>
        </paper-toolbar>
        <div id="main_container">
            <div id="yt-app-action">
                <ytsync-sources id="sources"></ytsync-sources>
                <div id="controls"></div>
            </div>
        </div>
        <paper-toast id="maxPlayers" text="You've reached the max ammount of players"></paper-toast>
    </template>

    <script>
        Polymer({
            is: 'ytsync-app',    
            attached: function() {
                this.$$("#control-menu").sourcesPlayers = this.$$("#sources");
                this.$$("#control-menu").controlsWrapper = this.$$("#controls");
            },
            addPlayer: function() {
                var player = this.$$("#sources").addPlayer();
                if(player === false) {
                    this.$.maxPlayers.open();
                    return;
                }
                var control = document.createElement("ytsync-control");
                control.sources = this.$$("#sources");
                control.playerId = player;
                Polymer.dom(this.$$("#controls")).appendChild(control);
            }
        });
    </script>
</dom-module>
